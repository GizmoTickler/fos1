apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: firewallrules.security.fos1.io
spec:
  group: security.fos1.io
  versions:
    - name: v1
      served: true
      storage: true
      schema:
        openAPIV3Schema:
          type: object
          properties:
            spec:
              type: object
              required: ["action"]
              properties:
                fromZone:
                  type: string
                  description: "Source zone (e.g., LAN, WAN, DMZ)"
                toZone:
                  type: string
                  description: "Destination zone (e.g., LAN, WAN, DMZ)"
                protocol:
                  type: string
                  description: "Protocol (e.g., tcp, udp, icmp)"
                  enum: ["tcp", "udp", "icmp", "any"]
                sourceIP:
                  type: string
                  description: "Source IP address or CIDR"
                destIP:
                  type: string
                  description: "Destination IP address or CIDR"
                sourcePort:
                  type: integer
                  description: "Source port number"
                  minimum: 1
                  maximum: 65535
                destPort:
                  type: integer
                  description: "Destination port number"
                  minimum: 1
                  maximum: 65535
                action:
                  type: string
                  description: "Action to take (allow, deny, reject)"
                  enum: ["allow", "deny", "reject"]
                priority:
                  type: integer
                  description: "Rule priority (lower value = higher priority)"
                  minimum: 1
                  maximum: 10000
      additionalPrinterColumns:
      - name: From
        type: string
        jsonPath: .spec.fromZone
      - name: To
        type: string
        jsonPath: .spec.toZone
      - name: Protocol
        type: string
        jsonPath: .spec.protocol
      - name: Action
        type: string
        jsonPath: .spec.action
      - name: Age
        type: date
        jsonPath: .metadata.creationTimestamp
  scope: Namespaced
  names:
    plural: firewallrules
    singular: firewallrule
    kind: FirewallRule
    shortNames:
    - fw
    - fwr
